# ~/.tmux.conf - Tmux configuration for security research
# Author: Adam Fasulo

# ===========================================
# General Settings
# ===========================================
# Set prefix to Ctrl-a (easier than Ctrl-b)
unbind C-b
set-option -g prefix C-a
bind-key C-a send-prefix

# Start window numbering at 1
set -g base-index 1
setw -g pane-base-index 1

# Renumber windows when one is closed
set -g renumber-windows on

# Increase history limit
set -g history-limit 50000

# Enable mouse support
set -g mouse on

# Reduce escape time (for vim)
set -sg escape-time 0

# Enable focus events
set -g focus-events on

# ===========================================
# Display Settings
# ===========================================
# 256 colors
set -g default-terminal "screen-256color"
set -ga terminal-overrides ",*256col*:Tc"

# Activity monitoring
setw -g monitor-activity on
set -g visual-activity off

# ===========================================
# Key Bindings
# ===========================================
# Reload config
bind r source-file ~/.tmux.conf \; display "Config reloaded!"

# Split windows with | and -
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
unbind '"'
unbind %

# Navigate panes with vim keys
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Navigate panes with Alt+arrow (no prefix)
bind -n M-Left select-pane -L
bind -n M-Right select-pane -R
bind -n M-Up select-pane -U
bind -n M-Down select-pane -D

# Resize panes with Ctrl+vim keys
bind -r C-h resize-pane -L 5
bind -r C-j resize-pane -D 5
bind -r C-k resize-pane -U 5
bind -r C-l resize-pane -R 5

# Navigate windows
bind -n S-Left previous-window
bind -n S-Right next-window

# Create new window in current directory
bind c new-window -c "#{pane_current_path}"

# Kill pane/window without confirmation
bind x kill-pane
bind X kill-window

# Synchronize panes (type in all panes at once)
bind S setw synchronize-panes

# ===========================================
# Copy Mode (vi-style)
# ===========================================
setw -g mode-keys vi

bind Enter copy-mode
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send -X copy-selection-and-cancel
bind -T copy-mode-vi Escape send -X cancel

# Copy to system clipboard (Linux)
bind -T copy-mode-vi y send -X copy-pipe-and-cancel "xclip -selection clipboard"

# ===========================================
# Status Bar
# ===========================================
set -g status on
set -g status-interval 5
set -g status-position bottom

# Status bar colors
set -g status-style fg=white,bg=black

# Left side: session name
set -g status-left-length 30
set -g status-left "#[fg=green,bold] #S #[fg=white]│ "

# Right side: host, date, time
set -g status-right-length 60
set -g status-right "#[fg=cyan]#H #[fg=white]│ #[fg=yellow]%Y-%m-%d #[fg=white]│ #[fg=green]%H:%M "

# Window status
setw -g window-status-format " #I:#W "
setw -g window-status-current-format "#[fg=black,bg=green,bold] #I:#W "

# ===========================================
# Pane Styling
# ===========================================
# Pane borders
set -g pane-border-style fg=colour240
set -g pane-active-border-style fg=green

# ===========================================
# Security Research Layouts
# ===========================================

# Layout: Main editor with terminals below
bind M-1 \
    split-window -v -p 30 \; \
    split-window -h \; \
    select-pane -t 0 \; \
    display "Layout: Editor + 2 terminals"

# Layout: 4-pane grid (monitoring)
bind M-2 \
    split-window -h \; \
    split-window -v \; \
    select-pane -t 0 \; \
    split-window -v \; \
    select-pane -t 0 \; \
    display "Layout: 4-pane grid"

# Layout: Wireshark + terminal
bind M-3 \
    split-window -v -p 25 \; \
    select-pane -t 0 \; \
    display "Layout: Main + bottom terminal"

# ===========================================
# Session Shortcuts
# ===========================================

# Quick session switcher
bind s choose-tree -Zs

# Create security research session
bind M-s \
    new-session -d -s security \; \
    rename-window -t security:1 'analysis' \; \
    new-window -t security -n 'network' \; \
    new-window -t security -n 'notes' \; \
    select-window -t security:1 \; \
    switch-client -t security \; \
    display "Security session created"

# ===========================================
# Hooks
# ===========================================
# Alert when command completes in background pane
set -g bell-action any

# ===========================================
# Message styling
# ===========================================
set -g message-style fg=white,bg=black,bold
set -g message-command-style fg=white,bg=black

